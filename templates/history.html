<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚½ãƒ¼ã‚¹å±¥æ­´æ¤œç´¢</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex">

  <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
  <div class="w-64 bg-white shadow-md p-6">
    <h2 class="text-xl font-bold mb-6">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
    <ul class="space-y-4 text-gray-700">
      <li><a href="/" class="hover:text-blue-500">ğŸ“ ã‚½ãƒ¼ã‚¹ä¿å­˜</a></li>
      <li><a href="/history" class="hover:text-blue-500 font-semibold">ğŸ“š ã‚½ãƒ¼ã‚¹å±¥æ­´</a></li>
    </ul>
  </div>

  <!-- ãƒ¡ã‚¤ãƒ³ -->
  <div class="flex-1 p-10">
    <h1 class="text-2xl font-bold mb-6">ã‚½ãƒ¼ã‚¹å±¥æ­´æ¤œç´¢</h1>

    <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
    <form method="POST" class="mb-8">
      <label class="block font-medium mb-2">æ¤œç´¢ã™ã‚‹IDã‚’å…¥åŠ›:</label>
      <input type="text" name="article_id" class="border border-gray-300 rounded p-2 w-64" required>
      <button type="submit" class="ml-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">æ¤œç´¢</button>
    </form>

    <!-- æ¤œç´¢çµæœ -->
    {% if searched %}
      <h2 class="text-xl font-bold mb-4">æ¤œç´¢çµæœ</h2>
      {% if results %}
        {% for row in results %}
          {% include "history_item.html" with context %}
        {% endfor %}
      {% else %}
        <p class="text-red-600 mb-10">è©²å½“ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
      {% endif %}
    {% endif %}

    <!-- ç›´è¿‘10ä»¶ -->
    <h2 class="text-xl font-bold mt-12 mb-4">ç›´è¿‘10ä»¶ã®å±¥æ­´</h2>
    {% for row in latest %}
      {% include "history_item.html" with context %}
    {% endfor %}
  </div>

  <!-- å‰Šé™¤ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded shadow-lg w-full max-w-md">
      <h2 class="text-xl font-bold mb-4">æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</h2>
      <p class="text-gray-600 mb-6">ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚</p>
      <form method="POST" action="/delete">
        <input type="hidden" name="delete_id" id="delete_id_input">
        <div class="flex justify-end space-x-3">
          <button type="button" onclick="closeModal()" class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="submit" class="px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600">å‰Šé™¤ã™ã‚‹</button>
        </div>
      </form>
    </div>
  </div>
  
  <script>
    function toggleSource(id) {
      const el = document.getElementById(id);
      el.classList.toggle("hidden");
    }
  
    function copyToClipboard(inputId) {
      const input = document.getElementById(inputId);
      navigator.clipboard.writeText(input.value);
      showToast("ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }
  
    function copySourceText(textId) {
      const text = document.getElementById(textId).innerText;
      navigator.clipboard.writeText(text);
      showToast("ã‚½ãƒ¼ã‚¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }
  
    function confirmDelete(event) {
      if (!confirm("ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
        event.preventDefault();
      }
    }

    function openModal(deleteId) {
        document.getElementById("delete_id_input").value = deleteId;
        document.getElementById("deleteModal").classList.remove("hidden");
      }
      
      function closeModal() {
        document.getElementById("deleteModal").classList.add("hidden");
      }      
  
    function showToast(message) {
      const toast = document.createElement("div");
      toast.className = "fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow-lg animate-fade";
      toast.innerText = message;
      document.body.appendChild(toast);
  
      setTimeout(() => {
        toast.remove();
      }, 2000);
    }
  </script>
  
  <style>
    @keyframes fade {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade {
      animation: fade 0.3s ease-in-out;
    }
  </style>
  
</body>
</html>
